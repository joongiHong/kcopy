<p align="center">
    <img src="../logo.png" width="300">
    <h1 align="center" style="font-size: 3em;">KCOPY DOCS</h1>
    <p align="center">
        <img src="https://img.shields.io/badge/python-v3.7-blue">
        <img src="https://img.shields.io/badge/license-MIT-green">
    </p>
    <p>KCOPY (Information of COVID-19 for Korean with Python)는 대한민국 정부에서 api를 통해 제공하는 검증된 정보를 손쉽게 얻을 수 있도록 도와드립니다. mask 또한 그중 하나입니다. 공적 마스크 판매처 및 재고 현황을 좌표 혹은 주소를 통해 손쉽게 조회할 수 있도록 도와드리는 mask 기능은 다음과 같은 방법으로 사용하실 수 있습니다.</p>
</p>

<br/>

## 일러두기

mask는 <b>건강보험심사평가원</b>의 도움으로 제공됩니다. 따라서 건강보험심가평가원측이 제공을 중단하거나 문제가 생겨 일시 중단될 경우 kcopy의 mask 또한 사용이 불가능 합니다. 이점 참고하여 주시기 바랍니다.

mask는 해당 판매점과 일정 시간 차이가 발생할 수 있습니다. 따라서 재고 수량과 판매점과 출발지의 거리를 고려하여 이용해 주시기 바랍니다.

## 시작하기

NiPy mask는 다음과 같은 모듈을 사용하기에 반드시 존재하여야 합니다.

- requests
- json

위의 모듈들의 설치가 완료되면 본 kcopy의 깃허브 저장소에서 `kcopy.py` 파일을 다운받아 원하는 프로젝트가 있는 폴더에 설치하시면 됩니다.

## Step.0 기초정보 설정 하기

kcopy mask는 별도의 기본 설정을 필요로 하지 않으나 활용자 설정을 하셔야 합니다.

```python
# m이라는 변수를 mask의 활용자로 지정합니다.
m = mask()
```

위의 예시는 m이라는 변수를 mask의 활용자로서 지정하고 사용합니다.

## Step.1 공적 마스크 판매처 조회하기

NiPy mask를 활용하면 공적 마스크 판매처를 불러올 수 있습니다. 공적 마스크 판매처를 불러오는 함수는 `store()`입니다.

```python
# 한 페이지에 500개씩 2페이지로 나누어 판매처를 조회합니다.
print(m.store(2, 500))
```

위의 예제는 공적 마스크 판매처 중 1000곳을 500곳씩 2페이지로 나누어 출력하는 예제입니다.

| 매개변수(예시) | 이름           | 설명                                                               |
| -------------- | -------------- | ------------------------------------------------------------------ |
| 2              | 페이지 수      | 판매점 정보를 출력할 페이지 수를 입력합니다. 숫자열 자료형 입니다. |
| 500            | 페이지 당 표시 | 페이지 당 표시할 판매점 개수를 입력합니다. 숫자열 자료형 입니다.   |

위의 매개변수를 올바르게 입력하시면 다음과 같은 결과를 받으실 수 있습니다.

```python
[{'addr': '충청남도 홍성군 갈산면 상촌로 12-1', 'code': '34840559', 'lat': 36.6029863, 'lng': 126.5489114, 'name': '신신약국', 'type': '01'}, ~~ {'addr': '충청남도 서천군 화양면 옥포길 8', 'code': 3098301985, 'lat': 36.0383839, 'lng': 126.7822793, 'name': '서천화양우체국', 'type': '02'}]
```

반환되는 결과는 리스트로 판매점을 구분하며 리스트 속에 판매점 정보를 담을 딕셔너리가 반환됩니다. 반환된 판매점 정보는 다음 키 값을 통해 접근할 수 있습니다.

| 키   | 이름        | 설명                                                             |
| ---- | ----------- | ---------------------------------------------------------------- |
| addr | 주소        | 판매점의 주소입니다.                                             |
| code | 고유코드    | 판매점별 고유코드입니다.                                         |
| lat  | 위도        | 판매점이 위치한 위도입니다.                                      |
| lng  | 경도        | 판매점이 위치한 경도입니다.                                      |
| name | 이름        | 판매점의 이름입니다.                                             |
| type | 판매점 분류 | 판매점의 종류입니다. 1은 `약국`, 2는 `우체국`, 3은 `농협`입니다. |

## Step.2 공적 마스크 판매처 별 재고 현황 조회하기

NiPy mask를 활용하면 공적 마스크 판매처 별 재고 현황을 불러올 수 있습니다. 공적 마스크 재조 현황을 불러오는 함수는 `stock()`입니다.

본 재고 현황 데이터를 시각화하여 제공할 때에는 정해진 색상으로 통일되게 시각화하여만 합니다.

### Step.2-1 무작위 판매처

특정 주소나 좌표가 아닌 무작위로 판매처를 조회할 수 있습니다.

```python
# 한 페이지에 500개씩 1페이지로 나누어 재고 현황을 조회합니다.
print(m.stock(1, 500))
```

위의 예제는 공적 마스크 판매처 중 500곳의 재고 현황을 출력하는 예제입니다.

| 매개변수(예시) | 이름           | 설명                                                               |
| -------------- | -------------- | ------------------------------------------------------------------ |
| 1              | 페이지 수      | 판매점 정보를 출력할 페이지 수를 입력합니다. 숫자열 자료형 입니다. |
| 500            | 페이지 당 표시 | 페이지 당 표시할 판매점 개수를 입력합니다. 숫자열 자료형 입니다.   |

위의 매개변수를 올바르게 입력하시면 다음과 같은 결과를 받으실 수 있습니다.

```python
[{'code': '3088301094', 'created_at': '2020/03/28 20:25:00', 'remain_stat': 'some', 'stock_at': '2020/03/27 11:00:00'}, {'code': '2238301167', 'created_at': '2020/03/28 20:25:00', 'remain_stat': 'some', 'stock_at': '2020/03/27 08:51:00'}, {'code': '12834807', 'created_at': '2020/03/28 20:25:00', 'remain_stat': 'plenty', 'stock_at': '2020/03/28 06:47:00'}]
```

반환되는 결과는 리스트로 판매점을 구분하며 리스트 속에 판매점 정보를 담을 딕셔너리가 반환됩니다. 반환된 판매점 정보는 다음 키 값을 통해 접근할 수 있습니다.

| 키           | 이름            | 설명                                                                                                                                                              |
| ------------ | --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| code         | 고유코드        | 판매점별 고유코드입니다.                                                                                                                                          |
| created_at   | 데이터 생성일자 | 데이터가 생성된 일자입니다.                                                                                                                                       |
| remain_start | 재고 상태       | `plenty` 100개 이상 (녹색),<br/>`some` 30개 이상 100개 미만 (노랑색),<br/> `few` 2개 이상 30개 미만 (빨강색),<br/> `empty` 1개 이하 (회색),<br/> `break` 판매중지 |
| stock_at     | 입고시간        | 마스크가 입고되는 시간입니다.                                                                                                                                     |

### Step.2-2 주소 기준 판매처

특정 주소를 입력하여 해당 주소지에 소재한 약국의 현황을 조회할 수 있습니다. 단 광역지자체만을 입력하여서는 안되며 최소 기초지자체까지 입력하셔야 합니다. `경기도(x) 경기도 김포시 (o)`

```python
# 서울특별시 강남구 대치동에 위치한 공적마스크 판매처의 재고 현황을 조회합니다.
print(m.add_stock('서울특별시 강남구 대치동'))
```

위의 예제는 서울특별시 강남구 대치동에 위치한 공적마스크 판매처의 재고 현황을 출력합니다.

| 매개변수(예시) | 이름 | 설명                                                           |
| -------------- | ---- | -------------------------------------------------------------- |
| 서울특별시     | 주소 | 조회할 판매점이 소재한 주소를 입력합니다. 문자열 자료형입니다. |

위의 매개변수를 올바르게 입력하시면 다음과 같은 결과를 받으실 수 있습니다.

```python
[{'addr': '서울특별시 강남구 영동대로86길 10 1층 (대치동)', 'code': '11800461', 'created_at': '2020/03/28 20:05:00', 'lat': 37.5078239, 'lng': 127.0649277, 'name': '메디칼희민약국', 'remain_stat': 'empty', 'stock_at': '2020/03/28 10:19:00', 'type': '01'}, ~~ {'addr': '서울특별시 강남구 테헤란로64길 9 지하1층 101호 (대치동, 선릉역대우아이빌)', 'code': '12870099', 'created_at': None, 'lat': 37.5044976, 'lng': 127.051631, 'name': '펜타약국', 'remain_stat': None, 'stock_at': None, 'type': '01'}]
```

반환되는 결과는 리스트로 판매점을 구분하며 리스트 속에 판매점 정보를 담을 딕셔너리가 반환됩니다. 반환된 판매점 정보는 다음 키 값을 통해 접근할 수 있습니다.

| 키           | 이름            | 설명                                                                                                                                                              |
| ------------ | --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| addr         | 판매처 주소     | 판매점이 소재한 주소입니다.                                                                                                                                       |
| lat          | 위도            | 판매점이 위치한 위도입니다.                                                                                                                                       |
| lng          | 경도            | 판매점이 위치한 경도입니다.                                                                                                                                       |
| name         | 이름            | 판매점의 이름입니다.                                                                                                                                              |
| code         | 고유코드        | 판매점별 고유코드입니다.                                                                                                                                          |
| created_at   | 데이터 생성일자 | 데이터가 생성된 일자입니다.                                                                                                                                       |
| remain_start | 재고 상태       | `plenty` 100개 이상 (녹색),<br/>`some` 30개 이상 100개 미만 (노랑색),<br/> `few` 2개 이상 30개 미만 (빨강색),<br/> `empty` 1개 이하 (회색),<br/> `break` 판매중지 |
| stock_at     | 입고시간        | 마스크가 입고되는 시간입니다.                                                                                                                                     |
| type         | 판매점 분류     | 판매점의 종류입니다. 1은 `약국`, 2는 `우체국`, 3은 `농협`입니다.                                                                                                  |

### Step.2-3 위도, 경도 기준 판매처

<p style="color: #CC3D3D;">본 기능이 현재 작동하고 있지 않습니다. 조치 때 까지만 기다려 주시기 바랍니다.</p>

특정 위도와 경도를 입력하여 해당 위치에 존재하는 판매처의 재고 현황을 조회할 수 있습니다.

```python
# 서울특별시 강남구 대치동에 위치한 공적마스크 판매처의 재고 현황을 조회합니다.
print(m.geo_stock(35, 130, 5000))
```

위의 예제는 서울특별시 강남구 대치동에 위치한 공적마스크 판매처의 재고 현황을 출력합니다. 위도 및 경도는 wgs84를 사용합니다.

| 매개변수(예시) | 이름 | 설명                                                                                       |
| -------------- | ---- | ------------------------------------------------------------------------------------------ |
| 35             | 위도 | 조회할 판매점이 소재한 위도를 입력합니다. 숫자열 자료형입니다. 33이상 43이하입니다.        |
| 130            | 경도 | 조회할 판매점이 소재한 경도를 입력합니다. 숫자열 자료형입니다. 124이상 132이하입니다.      |
| 5000           | 반경 | 입력한 위도, 경도의 반경을 입력합니다. 숫자열 자료형입니다. 최대 5000(5km)까지 가능합니다. |

위의 매개변수를 올바르게 입력하시면 다음과 같은 결과를 받으실 수 있습니다.

```python
[{"addr": "서울특별시 마포구 토정로 222 203호 (신수동, 한국출판협동조합)", "code": "12815608", "created_at": "2020/03/13 10:50:00", "lat": 37.5444976, "lng": 126.9352956,  "name": "진약국", "remain_stat": "empty", "stock_at": "2020/03/12 14:41:00", "type": "01"}]
```

반환되는 결과는 리스트로 판매점을 구분하며 리스트 속에 판매점 정보를 담을 딕셔너리가 반환됩니다. 반환된 판매점 정보는 다음 키 값을 통해 접근할 수 있습니다.

| 키           | 이름            | 설명                                                                                                                                                              |
| ------------ | --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| addr         | 판매처 주소     | 판매점이 소재한 주소입니다.                                                                                                                                       |
| lat          | 위도            | 판매점이 위치한 위도입니다.                                                                                                                                       |
| lng          | 경도            | 판매점이 위치한 경도입니다.                                                                                                                                       |
| name         | 이름            | 판매점의 이름입니다.                                                                                                                                              |
| code         | 고유코드        | 판매점별 고유코드입니다.                                                                                                                                          |
| created_at   | 데이터 생성일자 | 데이터가 생성된 일자입니다.                                                                                                                                       |
| remain_start | 재고 상태       | `plenty` 100개 이상 (녹색),<br/>`some` 30개 이상 100개 미만 (노랑색),<br/> `few` 2개 이상 30개 미만 (빨강색),<br/> `empty` 1개 이하 (회색),<br/> `break` 판매중지 |
| stock_at     | 입고시간        | 마스크가 입고되는 시간입니다.                                                                                                                                     |
| type         | 판매점 분류     | 판매점의 종류입니다. 1은 `약국`, 2는 `우체국`, 3은 `농협`입니다.                                                                                                  |

## 에러코드

kcopy를 사용하던 중 문제가 발생하면 다음과 같은 에러코드를 반환합니다.

| 에러코드    | 제목          | 설명                                                                                      |
| ----------- | ------------- | ----------------------------------------------------------------------------------------- |
| NO DATABASE | 데이터 없음   | 조회하였으나 데이터가 존재하지 않습니다.                                                  |
| VALUE ERROR | 매개변수 에러 | 매개변수의 자료형이나 길이 등에 문제가 발생하였습니다. 매뉴얼을 참고하여 입력해 주십시오, |
